---
interface Props {
  level: 'h2' | 'h3' | 'h4' | 'h5' | 'h6';
  text: string;
  id?: string;
  className?: string;
  _key?: string;
  _type?: string;
}

const props = Astro.props;
// Clean the level and text values to remove any invisible Unicode characters (stega encoding)
// These characters are added by Sanity's Visual Editing overlays for content tracking
const cleanLevel = props.level?.replace(/[\u200B-\u200D\uFEFF\u2060\u180E]/g, '').trim() as Props['level'];
const cleanText = props.text?.replace(/[\u200B-\u200D\uFEFF\u2060\u180E]/g, '').trim() || '';
const { id, className = '', _key, _type } = props;
const level = cleanLevel;
const text = cleanText;
---

{level === 'h2' && <h2 id={id} class={`heading-component ${className}`} data-component="heading" data-sanity={_key ? `${_type}.${_key}` : _type}>{text}</h2>}
{level === 'h3' && <h3 id={id} class={`heading-component ${className}`} data-component="heading" data-sanity={_key ? `${_type}.${_key}` : _type}>{text}</h3>}
{level === 'h4' && <h4 id={id} class={`heading-component ${className}`} data-component="heading" data-sanity={_key ? `${_type}.${_key}` : _type}>{text}</h4>}
{level === 'h5' && <h5 id={id} class={`heading-component ${className}`} data-component="heading" data-sanity={_key ? `${_type}.${_key}` : _type}>{text}</h5>}
{level === 'h6' && <h6 id={id} class={`heading-component ${className}`} data-component="heading" data-sanity={_key ? `${_type}.${_key}` : _type}>{text}</h6>}

<style>
  /* Heading component - Uses global design tokens for consistency
   *
   * This component now uses the refined modular scale from tokens.css.
   * Font sizes automatically scale fluidly across all viewport sizes
   * without needing media queries.
   *
   * The global heading styles from global.css already define the sizes,
   * so we only need to override margin and ensure proper spacing here.
   */
  .heading-component {
    width: min(100ch, 100% - 4rem);
    margin-inline: auto;
    margin-block: 2rem 1rem;
    font-weight: var(--font-weight-semibold);
    text-align: center;
  }

  h2.heading-component {
    font-size: var(--step-3);  /* 31-44px - Scales fluidly */
  }

  h3.heading-component {
    font-size: var(--step-2);  /* 26-35px - Scales fluidly */
  }

  h4.heading-component {
    font-size: var(--step-1);  /* 22-28px - Scales fluidly */
  }

  h5.heading-component {
    font-size: var(--step-0);  /* 18-23px - Scales fluidly */
    font-weight: var(--font-weight-semibold);
  }

  h6.heading-component {
    font-size: var(--step-0);  /* 18-23px - Scales fluidly */
    font-weight: var(--font-weight-medium);
  }

  /* When inside a layout context, fill parent space and center */
  :global([data-layout-context]) .heading-component {
    width: 100%;
    margin: 0;
    padding: var(--space-m-l); /* Fluid 16px â†’ 30px */
    display: flex;
    align-items: center;
    justify-content: center;
    text-align: center;
  }

  /* No media queries needed! Fluid typography handles all viewport sizes. */
</style> 