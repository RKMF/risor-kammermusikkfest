---
export const prerender = false;

import ArtistDetailContent from '../../../components/ArtistDetailContent.astro';
import { createDataService } from '../../../lib/sanity/dataService.js';
import type { ArtistResult } from '../../../lib/sanity/queries';

const { slug } = Astro.params;
if (!slug) return Astro.redirect('/en/404');

const dataService = createDataService(Astro.request);
let artist: ArtistResult | null = null;

try {
  artist = await dataService.getArtistBySlug(slug);
  if (!artist) return Astro.redirect('/en/404');
} catch (error) {
  console.error(`Error loading artist "${slug}":`, error);
  return Astro.redirect('/en/404');
}
---

<ArtistDetailContent artist={artist} language="en" />
